<!-- Main Hero Slider -->
<app-main-slider />

<!-- Loading State -->
<div *ngIf="isLoading" class="loading-section section-padding text-center">
    <div class="container">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">{{ 'LOADING' | translate }}</span>
        </div>
        <p class="mt-3">{{ 'LOADING' | translate }}...</p>
    </div>
</div>

<!-- Error State -->
<div *ngIf="error && !isLoading" class="error-section section-padding text-center">
    <div class="container">
        <div class="alert alert-warning">
            <i class="fa-solid fa-exclamation-triangle mb-3"></i>
            <p>{{ error }}</p>
            <button class="btn btn-primary" (click)="retryLoadData()">
                {{ 'TRY_AGAIN' | translate }}...
            </button>
        </div>
    </div>
</div>

<!-- Main Content -->
<div *ngIf="!isLoading && homeData">
    <!-- About Us Section -->
    <section class="about-section section-padding">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <div class="about-content">
                        <div class="section-header">
                            <span class="">{{ 'ABOUT_US' | translate }}</span>
                            <h2 class="section-title">{{ 'WHO_WE_ARE_TITLE' | translate }}</h2>
                            <p class="section-description">{{ 'ABOUT_US_DESC_1' | translate }}</p>
                            <p>{{ 'ABOUT_US_DESC_2' | translate }}</p>
                        </div>
                        <div class="about-features">
                            <div class="feature-item">
                                <div class="feature-icon">
                                    <i class="fa-solid fa-chart-line"></i>
                                </div>
                                <div class="feature-content">
                                    <h4>{{ 'LEARN_ANYWHERE' | translate }}</h4>
                                    <p>{{ 'LEARN_ANYWHERE_DESC' | translate }}</p>
                                </div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-icon">
                                    <i class="fa-solid fa-users"></i>
                                </div>
                                <div class="feature-content">
                                    <h4>{{ 'EXPERT_INSTRUCTOR' | translate }}</h4>
                                    <p>{{ 'EXPERT_INSTRUCTOR_DESC' | translate }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="about-cta">
                            <a routerLink="/about" class="btn btn-primary">
                                {{ 'READ_MORE' | translate }}
                                <i class="fa-solid ms-2"
                                    [ngClass]="{'fa-arrow-right': translate.currentLang === 'en', 'fa-arrow-left': translate.currentLang === 'ar'}"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="about-image">
                        <img src="assets/images/about-image.jpeg" alt="About Us" class="img-fluid rounded-3">
                        <div class="experience-badge">
                            <div class="badge-content">
                                <h3>{{ homeData.stats.yearsExperience }}+</h3>
                                <p>{{ 'YEARS_EXPERIENCE' | translate }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section class="services-section section-padding bg-light">
        <div class="container">
            <div class="section-header text-center">
                <span class="">{{ 'SERVICES' | translate }}</span>
                <h2 class="section-title text-center mt-2">{{ 'SERVICES_PAGE_DESC' | translate }}</h2>
            </div>
            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4" *ngFor="let service of defaultServices">
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fa-solid" [ngClass]="service.icon"></i>
                        </div>
                        <div class="service-content">
                            <h4>{{ service.title }}</h4>
                            <p>{{ service.description }}</p>
                            <a [routerLink]="service.link" class="service-link">
                                {{ 'READ_MORE' | translate }}
                                <i class="fa-solid ms-2"
                                    [ngClass]="{'fa-arrow-right': translate.currentLang === 'en', 'fa-arrow-left': translate.currentLang === 'ar'}"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Statistics Section -->
    <section class="stats-section section-padding" #statsSection>
        <div class="container">
            <!-- زر اختبار العداد -->
            <div class="text-center mb-4" *ngIf="!hasAnimated">
                <button class="btn btn-light" (click)="testCounter()">
                    <i class="fa-solid fa-play"></i> {{ 'START_COUNTER' | translate }}
                </button>
            </div>

            <div class="row">
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="stat-card text-center">
                        <div class="stat-icon">
                            <i class="fa-solid fa-chart-line"></i>
                        </div>
                        <div class="stat-number">{{ animatedStats.completedStudies }}+</div>
                        <div class="stat-label">{{ 'COMPLETED_STUDIES' | translate }}</div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="stat-card text-center">
                        <div class="stat-icon">
                            <i class="fa-solid fa-users"></i>
                        </div>
                        <div class="stat-number">{{ animatedStats.satisfiedClients }}+</div>
                        <div class="stat-label">{{ 'SATISFIED_CLIENTS' | translate }}</div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="stat-card text-center">
                        <div class="stat-icon">
                            <i class="fa-solid fa-trophy"></i>
                        </div>
                        <div class="stat-number">{{ animatedStats.yearsExperience }}+</div>
                        <div class="stat-label">{{ 'YEARS_EXPERIENCE' | translate }}</div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="stat-card text-center">
                        <div class="stat-icon">
                            <i class="fa-solid fa-handshake"></i>
                        </div>
                        <div class="stat-number">{{ animatedStats.successPartners }}+</div>
                        <div class="stat-label">{{ 'SUCCESS_PARTNERS_COUNT' | translate }}</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Latest Work Samples -->
    <section class="work-samples-section section-padding bg-light" *ngIf="homeData.latestWorkSamples.length > 0">
        <div class="container">
            <div class="section-header text-center">
                <span class="">{{ 'WORK_SAMPLES' | translate }}</span>
                <h2 class="section-title">{{ 'LATEST_WORK_SAMPLES' | translate }}</h2>
                <p class="section-description">{{ 'WORK_SAMPLES_DESC' | translate }}</p>
            </div>
            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4" *ngFor="let sample of homeData.latestWorkSamples">
                    <div class="work-sample-card">
                        <div class="work-image">
                            <img [src]="getImageUrl(sample.image_url, 'assets/images/work-sample-placeholder.jpg')"
                                [alt]="sample.title" class="img-fluid">
                            <div class="work-overlay">
                                <a [routerLink]="['/work-samples', sample.id]" class="work-link">
                                    <i class="fa-solid fa-eye"></i>
                                </a>
                            </div>
                        </div>
                        <div class="work-content">
                            <h4>{{ sample.title }}</h4>
                            <p>{{ truncateText(sample.description, 80) }}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4">
                <a routerLink="/work-samples" class="btn btn-primary">
                    {{ 'VIEW_ALL_WORK' | translate }}
                    <i class="fa-solid ms-2"
                        [ngClass]="{'fa-arrow-right': translate.currentLang === 'en', 'fa-arrow-left': translate.currentLang === 'ar'}"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Team Section -->
    <section class="team-section section-padding" *ngIf="homeData.teamMembers.length > 0">
        <div class="container">
            <div class="section-header text-center">
                <span class="">{{ 'OUR_INSTRUCTOR' | translate }}</span>
                <h2 class="section-title">{{ 'OUR_EXPERT_TEAM' | translate }}</h2>
                <p class="section-description">{{ 'EXPERT_TEAM_DESC' | translate }}</p>
            </div>
            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4" *ngFor="let member of homeData.teamMembers">
                    <div class="team-card text-center">
                        <div class="team-image">
                            <img [src]="getImageUrl(member.image_url, 'assets/images/team-placeholder.jpg')"
                                [alt]="member.name" class="img-fluid rounded-circle">
                        </div>
                        <div class="team-content">
                            <h4>{{ member.name }}</h4>
                            <p class="team-position">{{ member.position }}</p>
                            <div class="team-social" *ngIf="member.social_links">
                                <a [href]="member.social_links.linkedin" class="social-link"
                                    *ngIf="member.social_links.linkedin" target="_blank">
                                    <i class="fa-brands fa-linkedin"></i>
                                </a>
                                <a [href]="member.social_links.twitter" class="social-link"
                                    *ngIf="member.social_links.twitter" target="_blank">
                                    <i class="fa-brands fa-twitter"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4">
                <a routerLink="/team" class="btn btn-outline-primary">
                    {{ 'VIEW_ALL_TEAM' | translate }}
                </a>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="testimonials-section section-padding bg-light"
        *ngIf="homeData && homeData.testimonials && homeData.testimonials.length > 0">
        <div class="container">
            <div class="section-header text-center">
                <span class="">{{ 'TESTIMONIALS' | translate }}</span>
                <h2 class="section-title">{{ 'FEEDBACK_TITLE' | translate }}</h2>
                <p class="section-description">{{ 'CLIENT_TESTIMONIALS_DESC' | translate }}</p>
            </div>

            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4" *ngFor="let testimonial of homeData.testimonials | slice:0:3">
                    <div class="testimonial-card">
                        <div class="testimonial-content">
                            <div class="testimonial-rating">
                                <i class="fa-solid fa-star" *ngFor="let star of getStarsArray(testimonial.rating)"></i>
                            </div>
                            <p>"{{ testimonial.comment }}"</p>
                        </div>
                        <div class="testimonial-author">

                            <div class="author-info">
                                <h5>{{ testimonial.client_name }}</h5>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-center mt-4">
                <a routerLink="/testimonials" class="btn btn-primary">
                    {{ 'VIEW_ALL_TESTIMONIALS' | translate }}
                    <i class="fa-solid ms-2"
                        [ngClass]="{'fa-arrow-right': translate.currentLang === 'en', 'fa-arrow-left': translate.currentLang === 'ar'}"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Latest Posts -->
    <section class="posts-section section-padding" *ngIf="homeData.latestPosts.length > 0">
        <div class="container">
            <div class="section-header text-center">
                <span class="">{{ 'POSTS' | translate }}</span>
                <h2 class="section-title">{{ 'LATEST_ARTICLES' | translate }}</h2>
                <p class="section-description">{{ 'POSTS_DESC' | translate }}</p>
            </div>
            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4" *ngFor="let post of homeData.latestPosts">
                    <div class="post-card">
                        <div class="post-image">
                            <img [src]="getImageUrl(post.image_url, 'assets/images/post-placeholder.jpg')"
                                [alt]="post.title" class="img-fluid">
                            <div class="post-date">
                                <span class="date-day">{{ formatDate(post.created_at).split(' ')[0] }}</span>
                                <span class="date-month">{{ formatDate(post.created_at).split(' ')[1] }}</span>
                            </div>
                        </div>
                        <div class="post-content">

                            <h4 class="post-title">
                                <a [routerLink]="['/posts', post.id]">{{ post.title }}</a>
                            </h4>
                            <p class="post-excerpt">{{ truncateText(post.excerpt || post.content, 120) }}</p>
                            <a [routerLink]="['/posts', post.id]" class="post-link">
                                {{ 'READ_MORE' | translate }}
                                <i class="fa-solid ms-2"
                                    [ngClass]="{'fa-arrow-right': translate.currentLang === 'en', 'fa-arrow-left': translate.currentLang === 'ar'}"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4">
                <a routerLink="/posts" class="btn btn-outline-primary">
                    {{ 'VIEW_ALL_ARTICLES' | translate }}
                </a>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section section-padding bg-gradient">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <div class="cta-content">
                        <h2 class="cta-title">{{ 'NEED_FEASIBILITY_STUDY' | translate }}</h2>
                        <p class="cta-description">{{ 'FEASIBILITY_STUDY_CTA_DESC' | translate }}</p>
                    </div>
                </div>
                <div class="col-lg-4 text-center">
                    <div class="cta-buttons">
                        <a routerLink="/contacts" class="btn btn-outline-light btn-lg">
                            {{ 'CONTACT_US' | translate }}
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Partners Section -->
    <section class="partners-section section-padding"
        *ngIf="homeData && homeData.partners && homeData.partners.length > 0">
        <div class="container">
            <div class="section-header text-center">
                <span class="">{{ 'PARTNERS' | translate }}</span>
                <h2 class="section-title">{{ 'SUCCESS_PARTNERS' | translate }}</h2>
                <p class="section-description">{{ 'PROUD_PARTNERSHIP' | translate }}</p>
            </div>

            <div class="row justify-content-center">
                <div class="col-lg-4 col-md-6 col-sm-6 mb-4" *ngFor="let partner of homeData.partners | slice:0:3">
                    <div class="partner-item text-center">
                        <img [src]="getImageUrl(partner.logo_url, 'assets/images/partner-placeholder.png')"
                            [alt]="partner.name" class="img-fluid">
                    </div>
                </div>
            </div>

            <div class="text-center mt-4">
                <a routerLink="/partners" class="btn btn-primary">
                    {{ 'VIEW_ALL_PARTNERS' | translate }}
                    <i class="fa-solid ms-2"
                        [ngClass]="{'fa-arrow-right': translate.currentLang === 'en', 'fa-arrow-left': translate.currentLang === 'ar'}"></i>
                </a>
            </div>
        </div>
    </section>
</div>